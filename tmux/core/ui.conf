# core/ui.conf
#
# 主题 + 状态栏（尽量跨平台；Codex 等本机覆盖放在 local/）

# -- toggle_status

# -- theme

# panes
set -g @inactive_pane_bg '#141414'
run-shell "~/.config/tmux/scripts/update_theme_color.sh"
setw -g pane-border-status top
setw -g pane-border-lines single
set -g pane-border-style fg=colour244
setw -g pane-border-format '#{?#{pane_active}, #[fg=#{?#{!=:#{@active_border_color},},#{@active_border_color},#ff9f43}]#[bg=#{?#{!=:#{@active_border_color},},#{@active_border_color},#ff9f43}]#[fg=#1d1f21]#[bold] #{?#{&&:#{!=:#{pane_title},},#{!=:#{pane_title},#{pane_current_command}}},#{pane_title},#{window_name}} #[bg=default]#[fg=#{?#{!=:#{@active_border_color},},#{@active_border_color},#ff9f43}]#[default]#[fg=colour244] |#[default]#[fg=#{?window_zoomed_flag,colour196,#6cb6ff}]#[bg=#{?window_zoomed_flag,colour196,#6cb6ff}]#[fg=#1d1f21]#[bold] #{?window_zoomed_flag,⛶ ZOOM ,}#{?#{!=:#{@pane_label},},#{@pane_label},#{?#{!=:#{@pane_label_prefix},},#{@pane_label_prefix},}#(~/.config/tmux/scripts/pane_starship_title.sh #{pane_pid} #{pane_width} "#{pane_current_path}" "#{pane_current_command}")#{?#{!=:#{@pane_label_suffix},},#{@pane_label_suffix},}} #[bg=default]#[fg=#{?window_zoomed_flag,colour196,#6cb6ff}]#[default], #[fg=colour238]#[bg=colour238]#[fg=colour250] #{?#{&&:#{!=:#{pane_title},},#{!=:#{pane_title},#{pane_current_command}}},#{pane_title},#{window_name}} #[bg=default]#[fg=colour238]#[default]#[fg=colour244] |#[default]#[fg=colour244] #{?window_zoomed_flag,⛶ ,}#{?#{!=:#{@pane_label},},#{@pane_label},#{?#{!=:#{@pane_label_prefix},},#{@pane_label_prefix},}#(~/.config/tmux/scripts/pane_starship_title.sh #{pane_pid} #{pane_width} "#{pane_current_path}" "#{pane_current_command}")#{?#{!=:#{@pane_label_suffix},},#{@pane_label_suffix},}} #[default] }'
#set -g pane-active-border-style fg=brightblue
#set -g pane-border-style fg=magenta

# windows

# windows
set -g status-justify 'left'
set -g status-left-length 90
set -g status-right-length 140
setw -g window-status-separator ''

# default statusbar colors
set -g status-bg black

# 2-line status（让“当前窗口行 + 窗口 tabs 行”都可见）
set -g status 2
set -g status-style 'bg=black,fg=default'
set -g status-format[1] '#[bg=black]#[align=left range=left #{E:status-left-style}]#[push-default]#{T;=/#{status-left-length}:status-left}#[pop-default]#[norange default]#[list=on align=#{status-justify}]#[list=left-marker]<#[list=right-marker]>#[list=on]#{W:#[range=window|#{window_index} #{E:window-status-style}#{?#{&&:#{window_last_flag},#{!=:#{E:window-status-last-style},default}}, #{E:window-status-last-style},}#{?#{&&:#{window_bell_flag},#{!=:#{E:window-status-bell-style},default}}, #{E:window-status-bell-style},#{?#{&&:#{||:#{==:#{@unread_activity},1},#{window_silence_flag}},#{!=:#{E:window-status-activity-style},default}}, #{E:window-status-activity-style},}}]#[push-default]#{T:window-status-format}#[pop-default]#[norange default]#{?window_end_flag,,#{window-status-separator}},#[range=window|#{window_index} list=focus #{?#{!=:#{E:window-status-current-style},default},#{E:window-status-current-style},#{E:window-status-style}}#{?#{&&:#{window_last_flag},#{!=:#{E:window-status-last-style},default}}, #{E:window-status-last-style},}#{?#{&&:#{window_bell_flag},#{!=:#{E:window-status-bell-style},default}}, #{E:window-status-bell-style},#{?#{&&:#{||:#{==:#{@unread_activity},1},#{window_silence_flag}},#{!=:#{E:window-status-activity-style},default}}, #{E:window-status-activity-style},}}]#[push-default]#{T:window-status-current-format}#[pop-default]#[norange list=on default]#{?window_end_flag,,#{window-status-separator}}}#[nolist align=right range=right #{E:status-right-style}]#[push-default]#{T;=/#{status-right-length}:status-right}#[pop-default]#[norange default]'
#set -g status-left ' #[fg=magenta,bold]❐ #S'
#set -g status-left '#[fg=brightyellow] #{?client_prefix,⌨ ,  }  #[fg=magenta,bold] %Y-%m-%d %H:%M '
#set -g status-right '#(rainbarf --battery --remaining --bolt --tmux --rgb)'
#set -g status-left "#[fg=magenta,bold] %Y-%m-%d %H:%M | #[fg=brightblue]#(curl icanhazip.com) #(ifconfig en0 | grep 'inet ' | awk '{print \"en0 \" $2}') #(ifconfig en1 | grep 'inet ' | awk '{print \"en1 \" $2}') #(ifconfig en3 | grep 'inet ' | awk '{print \"en3 \" $2}') #(ifconfig tun0 | grep 'inet ' | awk '{print \"vpn \" $2}') "
setw -g window-status-format '#[fg=#c5c8c6] #{?#{||:#{==:#{@codex_done},1},#{==:#{@unread_activity},1}},#[fg=#{?#{==:#{@codex_done},1},#3fb950,colour208}]●#[fg=#c5c8c6] ,}#{?window_zoomed_flag,#[fg=colour196]⛶#[fg=#c5c8c6] ,}#I#{?#{>=:#{window_panes},8},⣿,#{?#{==:#{window_panes},7},⣷,#{?#{==:#{window_panes},6},⡷,#{?#{==:#{window_panes},5},⡶,#{?#{==:#{window_panes},4},⠶,#{?#{==:#{window_panes},3},⠖,#{?#{==:#{window_panes},2},⠆,·}}}}}}}#W '
setw -g window-status-current-format '#[fg=#6cb6ff,bold] #{?window_zoomed_flag,#[fg=colour196]⛶#[fg=#6cb6ff] ,}#I#{?#{>=:#{window_panes},8},⣿,#{?#{==:#{window_panes},7},⣷,#{?#{==:#{window_panes},6},⡷,#{?#{==:#{window_panes},5},⡶,#{?#{==:#{window_panes},4},⠶,#{?#{==:#{window_panes},3},⠖,#{?#{==:#{window_panes},2},⠆,·}}}}}}}#W '
setw -g window-status-activity-style bg=black
setw -g window-status-bell-style bg=black
#set-window-option -g window-status-current-format "#[fg=colour235, bg=colour27]⮀#[fg=colour255, bg=colour27] #I ⮁ #W #[fg=colour27, bg=colour235]⮀"

set -g status-format[0] "#{?client_prefix,#[fg=#1d1f21]#[bg=#{@theme_color}]#[bold]⌨#[default],}#[bg=default]#[align=left]#[fg=#{?#{!=:#{environ:TMUX_THEME_COLOR},},#{environ:TMUX_THEME_COLOR},#6cb6ff},bold] #{s/^[0-9]+-//:session_name} > #{window_name} #[fg=default,bg=default,nobold]"
set-option -g status-left "#(~/.config/tmux/tmux-status/left.sh)   "
set-option -g status-right "#(~/.config/tmux/tmux-status/right.sh)"
